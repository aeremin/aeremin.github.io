---
layout: post
title:  "Блага AliЕxpress'а"
---

Вдогонку к [предыдущему посту](https://aeremin.github.io/2022/07/10/external-indication.html): одновременно 
с его написанием заказал себе на пробу две управляемые по BLE RGB LED-ленты (точнее, два набора из
управляющего контролера и собственно ленты) - 
[такую](https://aliexpress.ru/item/3256804144201547.html?item_id=3256804144201547&sku_id=12000028782785224)
[такую](https://aliexpress.ru/item/1005001725281982.html?item_id=1005001725281982&sku_id=12000017444285284).
С надеждой, что раз они Bluetooth-управляемые - то должно быть не очень сложно расковырять протокол и
научиться управлять ими из своего приложения. Две заказал на тот случай, если у одного из контроллеров
протокол окажется проще :)

Приехали, включил первую, подключился через отличный [nRF Connect](https://play.google.com/store/apps/details?id=no.nordicsemi.android.mcp)
(реально, лучшее приложение для первичных экспериментов с разыми BLE-устройствами и прочей отладки).
Увидел, что у устройства есть всего одна BLE-характеристика, куда можно писать. Но содержание в ней
отображалось странное и что именно писать было непонятно.

К счастью, у устройства было имя - `ELK-BLEDOM`. Так что после пары минут гуглинга выяснилось, что кто-то
уже reverse engineered протокол и [опубликовал инфу](https://github.com/FergusInLondon/ELK-BLEDOM/blob/master/PROTCOL.md).
После этого прикрутить поддержку оказалось более-менее тривиально ([коммит](https://github.com/aeremin/ostranna_configurator/commit/3df898673c1e2665cd302992a625410351bc52ec)).

По традиции видео :)

<iframe width="560" height="315" src="https://www.youtube.com/embed/QxaUJCif_ME" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>

Лента на двери (изображающая замок) воткнута в розетку через блок питания. Лента на жене (потенциально
изображающая что-то носимое) запитана от павербанка и потребляет примерно 0.5A при напряжении ~5V.

В целом вариант с использованием дешевых (<1000₽, если искать скидки - то наверное можно и за 500р урвать)
и готовых LED-лент выглядит довольно перспективно.